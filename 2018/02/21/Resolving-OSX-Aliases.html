<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/devblog3/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Resolving Mac OS X Aliases in Python | Scott H. Hawley (alt. blog via fastpages)</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Resolving Mac OS X Aliases in Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Mac OSX aliases are not symbolic links. Trying to read one will probably crash your code." />
<meta property="og:description" content="Mac OSX aliases are not symbolic links. Trying to read one will probably crash your code." />
<link rel="canonical" href="https://drscotthawley.github.io/devblog3/2018/02/21/Resolving-OSX-Aliases.html" />
<meta property="og:url" content="https://drscotthawley.github.io/devblog3/2018/02/21/Resolving-OSX-Aliases.html" />
<meta property="og:site_name" content="Scott H. Hawley (alt. blog via fastpages)" />
<meta property="og:image" content="http://cdn.osxdaily.com/wp-content/uploads/2012/06/remove-alias-arrows-mac.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-21T00:00:00-06:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://drscotthawley.github.io/devblog3/2018/02/21/Resolving-OSX-Aliases.html"},"url":"https://drscotthawley.github.io/devblog3/2018/02/21/Resolving-OSX-Aliases.html","@type":"BlogPosting","image":"http://cdn.osxdaily.com/wp-content/uploads/2012/06/remove-alias-arrows-mac.jpg","headline":"Resolving Mac OS X Aliases in Python","dateModified":"2018-02-21T00:00:00-06:00","datePublished":"2018-02-21T00:00:00-06:00","description":"Mac OSX aliases are not symbolic links. Trying to read one will probably crash your code.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="/devblog3/assets/main.css">
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://drscotthawley.github.io/devblog3/feed.xml" title="Scott H. Hawley (alt. blog via fastpages)" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head><body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/devblog3/">Scott H. Hawley (alt. blog via fastpages)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/devblog3/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Resolving Mac OS X Aliases in Python</h1>
    <p class="post-meta"><time class="dt-published" datetime="2018-02-21T00:00:00-06:00" itemprop="datePublished">
        Feb 21, 2018
      </time>•<span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>
    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Mac OSX aliases are not symbolic links. Trying to read one may crash your code.</p>

<p>In an app I’m developing, I want users to be able to easily create a “library” of symbolic links to 
other places on their machine, and this is most easily achieved for many of them by Cmd-Option-Dragging and dropping the files.
This creates an “alias”, which is a special file that Apple dreamed up.  UNIX users are accustomed to symbolic links, and codes 
written in UNIX will not follow or “resolve” Mac aliases. Instead, they will cause an exception to be thrown.</p>

<p>There used to be some libraries to handle this, but they relied on Apple’s old Carbon framework which is no longer supported.
There is a <a href="https://mac-alias.readthedocs.io/en/latest/">mac_alias</a> package but the documentation is lacking. So, I found an 
<a href="https://hints.macworld.com/article.php?story=20021024064107356">old post on MacWorld</a> where one solution is given, and I ported that
for what I need.</p>

<p>Happy to share with you, so that you won’t have to worry about this.  As an added bonus, you can tell it to convert aliases to symbolic
links, so that “next time” you won’t have to deal with this.  Enjoy.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
#
# Resolve Mac OS X 'aliases' by finding where they point to
# Author: Scott H. Hawley
#
# Description:
# Mac OSX aliases are not symbolic links. Trying to read one will probably crash your code.
# Here a few routines to help. Run these to change the filename before trying to read a file.
# Intended to be called from within other python code
#
# Python port modified from https://hints.macworld.com/article.php?story=20021024064107356
#
# Requirements: osascript (AppleScript), platform, subprocess, shlex
#
# TODO: - could make it work in parallel when mutliple filenames are given
#
# NOTE: By default, this only returns the names of the original source files,
#       but if you set convert=True, it will also convert aliases to symbolic links.
#
</span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># returns true if a file is an OSX alias, false otherwise
</span><span class="k">def</span> <span class="nf">isAlias</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">already_checked_os</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">already_checked_os</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s">'Darwin'</span> <span class="o">!=</span> <span class="n">platform</span><span class="p">.</span><span class="n">system</span><span class="p">()):</span>  <span class="c1"># already_checked just saves a few microseconds ;-)
</span>        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">checkpath</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># osascript needs absolute paths
</span>    <span class="c1"># Next several lines are AppleScript
</span>    <span class="n">line_1</span><span class="o">=</span><span class="s">'tell application "Finder"'</span>
    <span class="n">line_2</span><span class="o">=</span><span class="s">'set theItem to (POSIX file "'</span><span class="o">+</span><span class="n">checkpath</span><span class="o">+</span><span class="s">'") as alias'</span>
    <span class="n">line_3</span><span class="o">=</span><span class="s">'if the kind of theItem is "alias" then'</span>
    <span class="n">line_4</span><span class="o">=</span><span class="s">'   return true'</span>
    <span class="n">line_5</span><span class="o">=</span><span class="s">'else'</span>
    <span class="n">line_6</span><span class="o">=</span><span class="s">'   return false'</span>
    <span class="n">line_7</span><span class="o">=</span><span class="s">'end if'</span>
    <span class="n">line_8</span><span class="o">=</span><span class="s">'end tell'</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s">"osascript -e '"</span><span class="o">+</span><span class="n">line_1</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_2</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_3</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_4</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_5</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_6</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_7</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_8</span><span class="o">+</span><span class="s">"'"</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>      <span class="c1"># shlex splits cmd up appropriately so we can call subprocess.Popen with shell=False (better security)
</span>    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">retval</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">line2</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'UTF-8'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">'true'</span> <span class="o">==</span> <span class="n">line2</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'resolve_osx_alias: Error: subprocess returned non-zero exit code '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">retval</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">None</span>


<span class="c1"># returns the full path of the file "pointed to" by the alias
</span><span class="k">def</span> <span class="nf">resolve_osx_alias</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">already_checked_os</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>        <span class="c1"># single file/path name
</span>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">already_checked_os</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s">'Darwin'</span> <span class="o">!=</span> <span class="n">platform</span><span class="p">.</span><span class="n">system</span><span class="p">()):</span>  <span class="c1"># already_checked just saves a few microseconds ;-)
</span>        <span class="k">return</span> <span class="n">path</span>
    <span class="n">checkpath</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># osascript needs absolute paths
</span>    <span class="c1"># Next several lines are AppleScript
</span>    <span class="n">line_1</span><span class="o">=</span><span class="s">'tell application "Finder"'</span>
    <span class="n">line_2</span><span class="o">=</span><span class="s">'set theItem to (POSIX file "'</span><span class="o">+</span><span class="n">checkpath</span><span class="o">+</span><span class="s">'") as alias'</span>
    <span class="n">line_3</span><span class="o">=</span><span class="s">'if the kind of theItem is "alias" then'</span>
    <span class="n">line_4</span><span class="o">=</span><span class="s">'   get the posix path of (original item of theItem as text)'</span>
    <span class="n">line_5</span><span class="o">=</span><span class="s">'else'</span>
    <span class="n">line_6</span><span class="o">=</span><span class="s">'return "'</span><span class="o">+</span><span class="n">checkpath</span><span class="o">+</span><span class="s">'"'</span>
    <span class="n">line_7</span> <span class="o">=</span><span class="s">'end if'</span>
    <span class="n">line_8</span> <span class="o">=</span><span class="s">'end tell'</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s">"osascript -e '"</span><span class="o">+</span><span class="n">line_1</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_2</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_3</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_4</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_5</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_6</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_7</span><span class="o">+</span><span class="s">"' -e '"</span><span class="o">+</span><span class="n">line_8</span><span class="o">+</span><span class="s">"'"</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>              <span class="c1"># shlex splits cmd up appropriately so we can call subprocess.Popen with shell=False (better security)
</span>    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">retval</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>        
        <span class="n">source</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'UTF-8'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">convert</span><span class="p">):</span>
            <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">checkpath</span><span class="p">)</span>
            <span class="n">os</span><span class="p">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">checkpath</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'resolve_osx_aliases: Error: subprocess returned non-zero exit code '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">retval</span><span class="p">))</span>
        <span class="n">source</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">return</span> <span class="n">source</span>


<span class="c1"># used for multiple files at a time, just a looped call to resolve_osx_alias
</span><span class="k">def</span> <span class="nf">resolve_osx_aliases</span><span class="p">(</span><span class="n">filelist</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>  <span class="c1"># multiple files
</span>    <span class="c1">#print("filelist = ",filelist)
</span>    <span class="k">if</span> <span class="p">(</span><span class="s">'Darwin'</span> <span class="o">!=</span> <span class="n">platform</span><span class="p">.</span><span class="n">system</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">filelist</span>
    <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">infile</span> <span class="ow">in</span> <span class="n">filelist</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">resolve_osx_alias</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">already_checked_os</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="n">convert</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">''</span> <span class="o">!=</span> <span class="n">source</span><span class="p">):</span>
            <span class="n">outlist</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="c1">#print("outlist = ",outlist)
</span>    <span class="k">return</span> <span class="n">outlist</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">argparse</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'Resolve OSX aliases'</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'file'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"alias files to resolve"</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s">'+'</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">outlist</span> <span class="o">=</span> <span class="n">resolve_osx_aliases</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nb">file</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"outlist = "</span><span class="p">,</span><span class="n">outlist</span><span class="p">)</span>
</code></pre></div></div>
<p>The above code is part of the <code class="language-plaintext highlighter-rouge">utils/</code> directory in my <a href="https://github.com/drscotthawley/panotti/tree/master/utils">Panotti</a> package.
The way it’s called is in the context of trying to read an audio file, called in the file <a href="https://github.com/drscotthawley/panotti/blob/master/panotti/datautils.py">panotti/datautils.py</a>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_audio</span><span class="p">(</span><span class="n">audio_path</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">convertOSXaliases</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>  <span class="c1"># wrapper for librosa.load
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">audio_path</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="n">mono</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">)</span>       <span class="c1"># try to read the file 'normally'
</span>    <span class="k">except</span> <span class="n">NoBackendError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>                                      
        <span class="k">if</span> <span class="p">(</span><span class="s">'Darwin'</span> <span class="o">==</span> <span class="n">platform</span><span class="p">.</span><span class="n">system</span><span class="p">()):</span>                           <span class="c1"># if an exception is thrown, check: Am I on a Mac? If so try to resolve an alias
</span>            <span class="n">source</span> <span class="o">=</span> <span class="n">resolve_osx_alias</span><span class="p">(</span><span class="n">audio_path</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="n">convertOSXaliases</span><span class="p">,</span> <span class="n">already_checked_os</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># ...and convert to symlinks for next time
</span>            <span class="k">try</span><span class="p">:</span>
                <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="n">mono</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">)</span>   <span class="c1"># Now try to read again
</span>            <span class="k">except</span> <span class="n">NoBackendError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>                               <span class="c1"># Ok, even that didn't work, giving up (for now).
</span>                <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">*** ERROR: Could not open audio file {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">audio_path</span><span class="p">),</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">flush</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>
        <span class="k">else</span><span class="p">:</span>                                                         <span class="c1"># Failure for some other reason. 
</span>            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">*** ERROR: Could not open audio file {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">audio_path</span><span class="p">),</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">flush</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span>
</code></pre></div></div>

<p>Happy coding!</p>

<p><em>NOTE: Currently this code only follows _one_ alias.  If there’s an alias pointing to an alias to a file, it won’t resolve to that file.
Full generality would involve adding an iterative or recursive way of traversing multiple aliases which…I may do later. ;-)</em></p>

  </div>
  

<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: silver;">Share on: </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=https://drscotthawley.github.io/2018/02/21/Resolving-OSX-Aliases.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=https://drscotthawley.github.io/2018/02/21/Resolving-OSX-Aliases.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=https://drscotthawley.github.io/2018/02/21/Resolving-OSX-Aliases.html&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    <div class="pinterest" title="Share this on Pinterest" onclick="window.open('https://pinterest.com/pin/create/button/?url=&media=https://drscotthawley.github.iohttp://cdn.osxdaily.com/wp-content/uploads/2012/06/remove-alias-arrows-mac.jpg&description=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M256 597q0-108 37.5-203.5t103.5-166.5 152-123 185-78 202-26q158 0 294 66.5t221 193.5 85 287q0 96-19 188t-60 177-100 149.5-145 103-189 38.5q-68 0-135-32t-96-88q-10 39-28 112.5t-23.5 95-20.5 71-26 71-32 62.5-46 77.5-62 86.5l-14 5-9-10q-15-157-15-188 0-92 21.5-206.5t66.5-287.5 52-203q-32-65-32-169 0-83 52-156t132-73q61 0 95 40.5t34 102.5q0 66-44 191t-44 187q0 63 45 104.5t109 41.5q55 0 102-25t78.5-68 56-95 38-110.5 20-111 6.5-99.5q0-173-109.5-269.5t-285.5-96.5q-200 0-334 129.5t-134 328.5q0 44 12.5 85t27 65 27 45.5 12.5 30.5q0 28-15 73t-37 45q-2 0-17-3-51-15-90.5-56t-61-94.5-32.5-108-11-106.5z"/></svg></div>
    <div class="gplus" title="Share this on Google Plus" onclick="window.open('https://plus.google.com/share?url=https://drscotthawley.github.io/2018/02/21/Resolving-OSX-Aliases.html');"><svg viewBox="0 0 2304 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1437 913q0 208-87 370.5t-248 254-369 91.5q-149 0-285-58t-234-156-156-234-58-285 58-285 156-234 234-156 285-58q286 0 491 192l-199 191q-117-113-292-113-123 0-227.5 62t-165.5 168.5-61 232.5 61 232.5 165.5 168.5 227.5 62q83 0 152.5-23t114.5-57.5 78.5-78.5 49-83 21.5-74h-416v-252h692q12 63 12 122zm867-122v210h-209v209h-210v-209h-209v-210h209v-209h210v209h209z"/></svg></div>
    <div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=https://drscotthawley.github.io/2018/02/21/Resolving-OSX-Aliases.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="drscotthawley/devblog3"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/devblog3/2018/02/21/Resolving-OSX-Aliases.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/devblog3/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Scott H. Hawley (alt. blog via fastpages)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Scott H. Hawley (alt. blog via fastpages)</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <li><a href="https://github.com/drscotthawley"><svg class="social svg-icon"><use xlink:href="/devblog3/assets/minima-social-icons.svg#github"></use></svg> <span class="username">drscotthawley</span></a></li><li><a href="https://www.twitter.com/%40drscotthawley"><svg class="social svg-icon"><use xlink:href="/devblog3/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">@drscotthawley</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>An alternate copy of my development blog, using fastpages. If successful I will replace the main blog with this</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
